# Interview Coach ‚Äî Web App (FastAPI + HTML/CSS + Voice Input)

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏–Ω—Ç–µ—Ä–≤—å—é: –æ–¥–∏–Ω —ç–∫—Ä–∞–Ω —Å –≤–æ–ø—Ä–æ—Å–æ–º, —Ñ–∏–¥–±–µ–∫–æ–º –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º. –ö–ª–∏–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ, —Å–µ—Ä–≤–µ—Ä ‚Äî FastAPI + websockets. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ—Ü–µ–Ω–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –¥–µ–ª–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ OpenRouter LLM.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```bash
pip install -r requirements.txt
uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
```
–û—Ç–∫—Ä—ã—Ç—å http://localhost:8000. –î–ª—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ –Ω—É–∂–µ–Ω –±—Ä–∞—É–∑–µ—Ä —Å MediaRecorder (Chrome/Edge). STT –∏–¥—ë—Ç —á–µ—Ä–µ–∑ faster-whisper –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- Backend: `app/main.py` –ø–æ–¥–Ω–∏–º–∞–µ—Ç FastAPI, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∏ websocket `/ws`. LLM –∫–ª–∏–µ–Ω—Ç—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ `interview_coach_core/openrouter.py`.
- Core-–ª–æ–≥–∏–∫–∞: `app/coach_engine.py` —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–µ—Å—Å–∏–µ–π, –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã, —à–ª—ë—Ç —Å—Ç–∞—Ç—É—Å—ã –∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã. –ü—Ä–æ–≥—Ä–µ—Å—Å/–∞–Ω–∞–ª–∏–∑ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `SessionState`.
- –ö–æ–Ω—Ç–µ–Ω—Ç: `interview_coach_core/parsing.py` —á–∏—Ç–∞–µ—Ç Markdown –≤ `NOTES_DIR`, —Ä–µ–∂–µ—Ç –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º –∏ –≤—ã—Ç–∞—Å–∫–∏–≤–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã/—Ç–µ–æ—Ä–∏—é –≤ `content_index`.
- –ü—Ä–æ–º–ø—Ç—ã –∏ —Å—Ö–µ–º—ã: `interview_coach_core/prompts.py` —Ö—Ä–∞–Ω–∏—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∏–¥–±–µ–∫–∞/–∞–Ω–∞–ª–∏—Ç–∏–∫–∏; `interview_coach_core/models.py` –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–∂–∏–¥–∞–µ–º—ã–π JSON (rubric, topic_scores –∏ —Ç.–ø.).
- STT: `/stt` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç faster-whisper (–º–æ–¥–µ–ª—å, –¥–µ–≤–∞–π—Å –∏ precision –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ env).
- –§—Ä–æ–Ω—Ç–µ–Ω–¥: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –≤ `app/static/` (`index.html`, `style.css`, `app.js`). –°–æ–æ–±—â–µ–Ω–∏—è —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è —á–µ—Ä–µ–∑ marked.js + DOMPurify; –≥–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ ‚Äî MediaRecorder ‚Üí POST `/stt` (faster-whisper).

## –ö–∞–∫ –∏–¥–µ—Ç –∑–∞–ø—Ä–æ—Å
1) –ö–ª–∏–µ–Ω—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `/` –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç websocket `/ws`.
2) –°–µ—Ä–≤–µ—Ä —à–ª—ë—Ç `hello` (–º–æ–¥–µ–ª—å, analyze_every_n, –ø—É—Ç–∏ –ª–æ–≥–æ–≤), –∑–∞—Ç–µ–º `question`.
3) –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –æ—Ç–≤–µ—Ç (—Ç–µ–∫—Å—Ç –∏–ª–∏ –≥–æ–ª–æ—Å), –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `answer`.
4) `CoachEngine.submit_answer` —Å–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –∏–∑ –≤–æ–ø—Ä–æ—Å–∞, expected (—Ä—É–±—Ä–∏–∫–∞) –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∑–æ–≤—ë—Ç `llm_eval` —Å `EVAL_SYSTEM`. –û—Ç–≤–µ—Ç –ø–∞—Ä—Å–∏—Ç—Å—è —á–µ—Ä–µ–∑ `robust_json_load`.
5) –§–∏–¥–±–µ–∫ (`feedback`) —É—Ö–æ–¥–∏—Ç –≤ UI; —Å—á—ë—Ç—á–∏–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ —Ä–∞—Å—Ç—ë—Ç. –ö–∞–∂–¥—ã–µ N –æ—Ç–≤–µ—Ç–æ–≤ ‚Äî `run_analysis` —Å `ANALYSIS_SYSTEM`, summary –ø–∞–¥–∞–µ—Ç –≤ –ª–µ–Ω—Ç—É.
6) –ù–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –∏–ª–∏ —Å–±—Ä–æ—Å–∞ —Å–µ—Å—Å–∏–∏.

## –§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –ö–æ–Ω—Å–ø–µ–∫—Ç—ã ‚Äî Markdown —Ñ–∞–π–ª—ã –≤ `NOTES_DIR`. –ó–∞–≥–æ–ª–æ–≤–∫–∏ `#/##/###` —Ñ–æ—Ä–º–∏—Ä—É—é—Ç —Ç–µ–º—ã. –í–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—Ç–∞—Å–∫–∏–≤–∞—é—Ç—Å—è –≤–æ–ø—Ä–æ—Å—ã (—Å—Ç—Ä–æ–∫–∏ —Å `?`, `Q:` –∏ —Ç.–ø.).
- –î–ª—è –∫–∞–∂–¥–æ–π —Ç–µ–º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è: `title`, `source_file`, `theory` (—Ç–µ–∫—Å—Ç —Å–µ–∫—Ü–∏–∏), `questions` (—Å–ø–∏—Å–æ–∫ {q, expected=None}).
- –ï—Å–ª–∏ –≤ —Å–µ–∫—Ü–∏–∏ –Ω–µ—Ç —è–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞—ë—Ç –∏—Ö –Ω–∞ –ª–µ—Ç—É. –ï—Å–ª–∏ –Ω–µ—Ç —á–µ–∫–ª–∏—Å—Ç–∞ expected, –æ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ JSON-—Ä—É–±—Ä–∏–∫–∞ (—Å–º. –ø—Ä–æ–º–ø—Ç –≤ `coach_engine.py`).

## –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
- `app/main.py` ‚Äî —Å–µ—Ä–≤–µ—Ä, websocket –ø—Ä–æ—Ç–æ–∫–æ–ª.
- `app/coach_engine.py` ‚Äî —Å–µ—Å—Å–∏–∏, —Å—Ç–∞—Ç—É—Å—ã, –æ—Ü–µ–Ω–∫–∞, –∞–Ω–∞–ª–∏–∑, –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é.
- `interview_coach_core/prompts.py` ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è Evaluator/Analyzer.
- `interview_coach_core/models.py` ‚Äî pydantic-—Å—Ö–µ–º—ã –æ–∂–∏–¥–∞–µ–º—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –º–æ–¥–µ–ª–µ–π.
- `interview_coach_core/parsing.py` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Å–ø–µ–∫—Ç–æ–≤, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ `content_index`.
- `app/static/*` ‚Äî —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (UI, —Å—Ç–∏–ª–∏, —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ Markdown, –≥–æ–ª–æ—Å).

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (env)
- `OPENROUTER_API_KEY` ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∫–ª—é—á.
- `OPENROUTER_MODEL` ‚Äî –º–æ–¥–µ–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏/–æ—Ü–µ–Ω–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é deepseek/deepseek-chat).
- `NOTES_DIR` ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —Å –∫–æ–Ω—Å–ø–µ–∫—Ç–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `./conspects`).
- `RUNS_DIR` ‚Äî –∫–∞—Ç–∞–ª–æ–≥ –¥–ª—è –ª–æ–≥–æ–≤ —Å–µ—Å—Å–∏–π (`runs/<ts>/history.jsonl` + snapshot —Ç–µ–º).
- `ANALYZE_EVERY_N` ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30).
- `MAX_QUESTIONS_PER_SOURCE` ‚Äî –ª–∏–º–∏—Ç –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ–¥–∏–Ω —Ñ–∞–π–ª –∫–æ–Ω—Å–ø–µ–∫—Ç–∞ (0 = –±–µ–∑ –ª–∏–º–∏—Ç–∞).
- `APP_HTTP_REFERER`, `APP_TITLE`, `LLM_TIMEOUT_S` ‚Äî –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ/—Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è OpenRouter.
- `WHISPER_MODEL` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é medium), `WHISPER_DEVICE`, `WHISPER_COMPUTE_TYPE` (int8_float16 –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏), `WHISPER_INITIAL_PROMPT`, `WHISPER_LANGUAGE` ("" = –∞–≤—Ç–æ), `WHISPER_BEAM_SIZE` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2), `WHISPER_CONDITION_ON_PREV` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ faster-whisper.

## –õ–æ–≥–∏ –∏ –∏—Å—Ç–æ—Ä–∏—è
- –î–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–∞—Ç–∞–ª–æ–≥ `runs/<timestamp>/`:
  - `history.jsonl` ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–æ–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤/–æ—Ü–µ–Ω–æ–∫.
  - `topics_snapshot.json` ‚Äî —Å–ø–∏—Å–æ–∫ —Ç–µ–º (id, title, source_file) –Ω–∞ –º–æ–º–µ–Ω—Ç —Å—Ç–∞—Ä—Ç–∞.
- –í UI –∏—Å—Ç–æ—Ä–∏—è —Å–µ—Å—Å–∏–∏ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–º debug drawer.

## –†–∞–±–æ—Ç–∞ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º
- –í—Å–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Ñ–∞–π–ª—ã –ª–µ–∂–∞—Ç –≤ `app/static/`. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ JS/CSS –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.
- –õ–µ–Ω—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –≤–æ–ø—Ä–æ—Å —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –∫–∞–∫ Markdown; —Ñ–æ—Ä–º—É–ª—ã –≤ `$...$/$$...$$` –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º CSS.
- –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥: –∫–Ω–æ–ø–∫–∞ üéôÔ∏è/‚è∫Ô∏è –º–µ–Ω—è–µ—Ç –∫–ª–∞—Å—Å `.listening`, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π.

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞
- –ó–∞–ø—É—Å–∫: `uvicorn app.main:app --reload`. Websocket –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è ‚Äî reload —Å–∞–º –æ–±–Ω–æ–≤–∏—Ç backend.
- –ù–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–π/–ë–î: –≤—Å—ë stateful –Ω–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –≤ `runs/`.
- –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å JSON-–æ—Ç–≤–µ—Ç–∞–º–∏ LLM: —Å–º–æ—Ç—Ä–∏ —Å–æ–±—ã—Ç–∏—è –≤ debug drawer –∏ `history.jsonl`; `robust_json_load` –≤—ã—Ä–µ–∑–∞–µ—Ç –ø–µ—Ä–≤—ã–π JSON-–±–ª–æ–∫, –∞ –ø—Ä–∏ –ø–æ–ª–æ–º–∫–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è recovery-–ø—Ä–æ–º–ø—Ç.

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –∏–¥–µ–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è
- –ù–µ—Ç –±–µ–∫–µ–Ω–¥–∞ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏/–º—É–ª—å—Ç–∏-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äî –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫.
- –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Å–ø–µ–∫—Ç–æ–≤ –ø—Ä–æ—Å—Ç–æ–π (–ø–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º); –¥–ª—è —Å–ª–æ–∂–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å `parsing.py`.
- –î–ª—è —Ç–æ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –ª—É—á—à–µ –¥–µ—Ä–∂–∞—Ç—å —á–µ–∫–ª–∏—Å—Ç—ã/—Ä—É–±—Ä–∏–∫–∏ –≤ –∫–æ–Ω—Å–ø–µ–∫—Ç–∞—Ö –∑–∞—Ä–∞–Ω–µ–µ, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å LLM-–¥–æ–≥–∞–¥–∫–∏.
